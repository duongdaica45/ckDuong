<!-- <!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Full-Stack Demo</title>
</head>
<body>
    <h1>üõí Demo Project: L·∫•y D·ªØ Li·ªáu S·∫£n Ph·∫©m</h1>
    <div id="status">ƒêang t·∫£i d·ªØ li·ªáu t·ª´ Backend...</div>
    <ul id="product-list"></ul>
    
    <script>
        const API_URL = 'http://localhost:8000'; // ƒê·ªãa ch·ªâ API Backend

        async function fetchProducts() {
            const statusDiv = document.getElementById('status');
            const list = document.getElementById('product-list');
            list.innerHTML = '';
            
            try {
                // G·ªçi API Endpoint
                const response = await fetch(API_URL);
                const result = await response.json();

                if (result.success) {
                    statusDiv.innerHTML = `<span style='color: green;'>‚úÖ Backend API ƒë√£ ph·∫£n h·ªìi: ${result.message}</span>`;
                    
                    if (result.data.length === 0) {
                        list.innerHTML = '<li>Kh√¥ng c√≥ s·∫£n ph·∫©m n√†o.</li>';
                        return;
                    }

                    // Hi·ªÉn th·ªã d·ªØ li·ªáu s·∫£n ph·∫©m
                    result.data.forEach(product => {
                        const li = document.createElement('li');
                        li.textContent = `${product.name} - $${product.price}`;
                        list.appendChild(li);
                    });
                } else {
                    statusDiv.innerHTML = `<span style='color: red;'>‚ùå L·ªói API: ${result.message}</span>`;
                }

            } catch (error) {
                // L·ªói m·∫°ng ho·∫∑c CORS
                statusDiv.innerHTML = `<span style='color: red;'>‚ùå L·ªói k·∫øt n·ªëi Frontend v·ªõi Backend (Ki·ªÉm tra CORS ho·∫∑c Nginx): ${error.message}</span>`;
            }
        }

        fetchProducts();
    </script>
</body>
</html>
 -->
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Full-Stack Demo: Cart</title>
    <style>
        .product-item { margin-bottom: 10px; border: 1px solid #ccc; padding: 10px; }
        .cart-link { margin-left: 20px; cursor: pointer; color: blue; text-decoration: underline; }
    </style>
</head>
<body>
    <h1>üõí Demo Project: S·∫£n ph·∫©m v√† Gi·ªè h√†ng</h1>
    
    <button onclick="fetchProducts()">T·∫£i l·∫°i S·∫£n ph·∫©m</button>
    <span class="cart-link" onclick="viewCart()">Xem Gi·ªè h√†ng (API)</span>

    <div id="status">ƒêang t·∫£i d·ªØ li·ªáu s·∫£n ph·∫©m...</div>
    <div id="product-list"></div>
    
    <h2>Gi·ªè h√†ng (<span id="cart-status">Ch∆∞a t·∫£i</span>)</h2>
    <ul id="cart-content"></ul>

    <script>
        const API_URL = 'http://localhost:8000'; 

        // --- H√ÄM 1: T·∫£i S·∫£n ph·∫©m ---
        async function fetchProducts() {
            const statusDiv = document.getElementById('status');
            const list = document.getElementById('product-list');
            list.innerHTML = '';
            statusDiv.textContent = 'ƒêang t·∫£i...';
            
            try {
                const response = await fetch(API_URL + '/products'); // G·ªçi API /products
                const result = await response.json();

                if (result.success) {
                    statusDiv.innerHTML = `<span style='color: green;'>‚úÖ T·∫£i s·∫£n ph·∫©m th√†nh c√¥ng.</span>`;
                    
                    result.data.forEach(product => {
                        const div = document.createElement('div');
                        div.className = 'product-item';
                        div.innerHTML = `
                            <strong>${product.name}</strong> - $${product.price} 
                            <button onclick="addToCart(${product.id}, '${product.name}')">Th√™m v√†o Gi·ªè</button>
                        `;
                        list.appendChild(div);
                    });
                } else {
                    statusDiv.innerHTML = `<span style='color: red;'>‚ùå L·ªói API: ${result.message}</span>`;
                }
            } catch (error) {
                statusDiv.innerHTML = `<span style='color: red;'>‚ùå L·ªói k·∫øt n·ªëi API /products.</span>`;
            }
        }

        // --- H√ÄM 2: Th√™m v√†o Gi·ªè h√†ng ---
        async function addToCart(productId, productName) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = `ƒêang th√™m ${productName} v√†o gi·ªè...`;
            
            try {
                // Gi·∫£ l·∫≠p cu·ªôc g·ªçi POST API /add-to-cart
                const response = await fetch(API_URL + '/add-to-cart', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ product_id: productId, quantity: 1 })
                });
                const result = await response.json();

                if (result.success) {
                    alert(`${result.message}: ${productName}`);
                    viewCart(); // T·∫£i l·∫°i gi·ªè h√†ng sau khi th√™m
                } else {
                    alert(`Th√™m v√†o gi·ªè th·∫•t b·∫°i: ${result.message}`);
                }
            } catch (error) {
                alert(`L·ªói m·∫°ng khi th√™m v√†o gi·ªè: ${error.message}`);
            }
        }
        
        // --- H√ÄM 3: Xem Gi·ªè h√†ng ---
        async function viewCart() {
            const cartStatus = document.getElementById('cart-status');
            const cartContent = document.getElementById('cart-content');
            cartContent.innerHTML = '';
            cartStatus.textContent = 'ƒêang t·∫£i...';

            try {
                const response = await fetch(API_URL + '/cart'); // G·ªçi API /cart
                const result = await response.json();

                if (result.success) {
                    cartStatus.innerHTML = `<span style='color: green;'>T·∫£i th√†nh c√¥ng.</span>`;
                    
                    if (result.data && result.data.length > 0) {
                        result.data.forEach(item => {
                            const li = document.createElement('li');
                            li.textContent = `${item.name} (S·ªë l∆∞·ª£ng: ${item.quantity}) - $${item.price}`;
                            cartContent.appendChild(li);
                        });
                    } else {
                        cartContent.innerHTML = '<li>Gi·ªè h√†ng tr·ªëng.</li>';
                    }
                } else {
                    cartStatus.innerHTML = `<span style='color: red;'>L·ªói: ${result.message}</span>`;
                }

            } catch (error) {
                cartStatus.innerHTML = `<span style='color: red;'>L·ªói k·∫øt n·ªëi API /cart.</span>`;
            }
        }

        fetchProducts(); // T·∫£i s·∫£n ph·∫©m khi kh·ªüi ƒë·ªông
    </script>
</body>
</html>